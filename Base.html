<html>
    <style type = "text/css">
        canvas {background: red}
    </style>

    <script type = "text/javascript" src = "webgl-utils.js"></script>
    <script type = "text/javascript" src = "initShaders.js"></script>
    <script type = "text/javascript" src = "verticalGradient.js"></script>

    <script id="vertex-shader" type = "x-shader/x-vertex">
        attribute vec4 vPos;
        void main() {
            gl_Position = vPos;
        }
    </script>

    <script id="fragment-shader" type="x-shader/x-fragment">
        precision mediump float;
        uniform vec4 u_color;

        void main() {
            gl_FragColor = u_color;
        }
    </script>

    <script type = "text/javascript">
        var canvas;
        var gl;

        window.onload = init;

        //Initializing canvas with width/height defined in body + painting background
        function init() {
            canvas = document.getElementById("gl-canvas");
            gl = WebGLUtils.setupWebGL(canvas);

            if(!gl) {
                alert("WebGL is not available :(");
            }

            gl.viewport(0,0, canvas.width, canvas.height);

            gl.clearColor(0.89, 0.73, .45, 1.0); //228,188,116 in 256 scale
            gl.clear(gl.COLOR_BUFFER_BIT);

            var program = initShaders(gl, "vertex-shader", "fragment-shader");
            gl.useProgram(program);

            var vPos = gl.getAttribLocation(program, "vPos");
            var colorUniformLocation = gl.getUniformLocation(program, "u_color");
            var buffer = gl.createBuffer();
            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
            

            //Hard work is done. Now, let's start with the sunset!

            /*Don't forget minY is NOT the bottom of the canvas since we have a background color.
            Also don't forget to change the last value when adding new colors since calculations 
            are based on it*/
            var vertices = verticalGradient(-1.00, 1.00, -0.8, 0.8, 4);

            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);

            gl.useProgram(program);
            gl.enableVertexAttribArray(vPos);
            gl.vertexAttribPointer(vPos, 2, gl.FLOAT, false, 0, 0);

            /*Now, we get to actually draw stuff.
            Don't forget to put new vertices in the array.
            !!They will not show up as an error!! They will just not show up!!
            */
            //We're starting with a gradient, going from gold to dark blue to purple.

            /*TODO: Put all colors in one array like Dr. Brown did for T3HouseFinal
            I just like how it's organized, and it would save some trouble. Could write
            a loop super easy (like he did), and since each of these triangles are 4 vertices...
            */

            gl.uniform4f(colorUniformLocation, 0.8, 0.59, 0.4, 1.0);
            gl.drawArrays(gl.TRIANGLE_FAN, 0, 4);

            gl.uniform4f(colorUniformLocation, 0.56, 0.52, 0.5, 1.0);
            gl.drawArrays(gl.TRIANGLE_FAN, 4, 4);

            gl.uniform4f(colorUniformLocation, 0.27, 0.27, 0.3, 1.0);
            gl.drawArrays(gl.TRIANGLE_FAN, 8, 4);

            gl.uniform4f(colorUniformLocation, 0.13, 0.24, 0.29, 1.0);
            gl.drawArrays(gl.TRIANGLE_FAN, 12, 4);
        }
    </script>

    <body>
        <canvas id = "gl-canvas" width = "512" height = "512">
            Oopsy!
        </canvas>
    </body>
</html>